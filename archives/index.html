<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">

<head>
  <meta charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <title>Archives | 痴呆屋</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:type" content="website">
<meta property="og:title" content="痴呆屋">
<meta property="og:url" content="https://rosystain.com/archives/index.html">
<meta property="og:site_name" content="痴呆屋">
<meta property="og:locale">
<meta property="article:author" content="Chock">
<meta name="twitter:card" content="summary">
  <!-- build:css css/screen.css -->

  
<link rel="stylesheet" href="/css/screen.css">

  
  <!-- endbuild -->
  
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
  <meta name="generator" content="痴呆屋">
  
  
  
</head>


<body class="home-template">

  <header class="main-header  "  style="background-image: url(https://i.loli.net/2020/10/01/yNHjrehS2dvC4gE.png)" >
    <nav class="main-nav overlay clearfix">
        
        <a class="subscribe-button icon-feed" href="/atom.xml">Subscribe</a>
    </nav>
    
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="https://i.loli.net/2020/10/01/DLrZt28dBi3NI19.png" alt="Blog Logo"/></a>         
            <!--<h1 class="page-title">痴呆屋</h1>
            <h2 class="page-description"></h2>-->
        </div>
    </div>
    
    <!--<a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a> -->
</header>

  
<main id="content" class="content" role="main">
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Notes/2023/03/15/clf8mfdk600001np6h59wfqrg/">使用 Home Assistant 控制 Logitech Unifying 频道</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>自入手 MX Master 2S 起就对罗技的 Unifying 优联系列颇为钟爱，后来也把键盘换成了魔改 K375s 的 DIY 键盘。优联的 Flow 在双机双屏的情况下频道切换十分自如，但相较而言在双机共用一屏的时候因为手动切换频道的按键在鼠标底部就显得十分不便了。</p>
<p>此时购买带 KVM 的 HDMI 切换器使两台电脑共用一个接收器算是比较简单粗暴的办法，但因为听到不少关于此类切换器可能会在使用中遇到各种Bug迟迟没有下手。</p>
<p>于是我便想，有没有一种方法可以用命令来切换键鼠的频道，从而进一步设定调用规则来实现双机一屏的自动切换呢？想着想着我便找到了这个项目 <a target="_blank" rel="noopener" href="https://github.com/marcelhoffs/input-switcher">marcelhoffs/input-switcher</a>。经过 2 天的测试算是得到了一个相对满意的结果，特此记录一下。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>此脚本的原理大概是利用 <a target="_blank" rel="noopener" href="https://github.com/todbot/hidapitester/">hidapitester</a> 直接向特定硬件 ID 的 USB 设备发送一串 16 进制的报文来实现频道切换。具体报文可以通过分析 Linux 下的罗技驱动程序 <a target="_blank" rel="noopener" href="https://github.com/pwr-Solaar/Solaar">Solaar</a> 进行推测，原 Repo 只提供了 MX Anywhere 和 MX Keys 的报文，在实际使用中发现并不能兼容我的 MX Master 2S 与 K375s，因此需要自行使用 Solaar 提取。</p>
<p>随便起一个 Ubuntu 虚拟机，桌面环境可以直接从自带的应用中心搜索安装 Solaar。</p>
<p><img src="/images/pasted-4.png" alt="upload successful"></p>
<p>随后打开 Solaar，插上接收器，设备列表中已配对的设备会亮起，此时打开终端，先查询下MX Master 2S</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solaar -dd config &quot;MX Master 2S&quot; change-host 1 #任意其他频道，此处使用频道1</span><br></pre></td></tr></table></figure>
<p>顺利的话会返回以下信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logitech_receiver.base: (17) &lt;&#x3D; w[11 01 091A 01000000000000000000000000000000]</span><br></pre></td></tr></table></figure>
<p>根据 <a target="_blank" rel="noopener" href="https://github.com/marcelhoffs/input-switcher">marcelhoffs/input-switcher</a> 的说明，可以确认 MX Master 2S 切换至频道 1 时所发送的报文对应到 hidapitester 的格式为 <code>11,01,09,1A,01,00,00</code>。其中 <code>09</code> 对应具体的设备型号，<code>1A</code> 是一个随机数，这里只需要记住这两个数值即可。</p>
<p>同样的办法查询 K375s</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solaar -dd config &quot;K375s&quot; change-host 1</span><br></pre></td></tr></table></figure>
<p>返回以下信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logitech_receiver.base: (19) &lt;&#x3D; w[11 03 081D 01000000000000000000000000000000]</span><br></pre></td></tr></table></figure>
<p>记录 <code>081D</code>。</p>
<h2 id="配置脚本"><a href="#配置脚本" class="headerlink" title="配置脚本"></a>配置脚本</h2><p>下载 <a target="_blank" rel="noopener" href="https://github.com/marcelhoffs/input-switcher">marcelhoffs/input-switcher</a> ，分别将对应系统的可执行文件（hdiapitester）与示例脚本放在适当的路径下。</p>
<h4 id="1-Windows"><a href="#1-Windows" class="headerlink" title="1. Windows"></a>1. Windows</h4><p>我在 Windows 下使用优联的频道1，希望通过脚本切换到频道2。</p>
<p>编辑 <code>switch_to_2.bat</code>，找到 <code>--send-output 0x10,0x01,0x09,0x1e,0x01,0x00,0x00</code> 字段，其中，开头的 <code>0x10</code> 为固定数值，紧接的 <code>0x01</code> 对应优联配对程序中的设备顺序（通常 <code>0x01</code> 对应键盘， <code>0x02</code> 对应鼠标，可在优联配对程序的高级设置中确认顺序），第三位第四位 <code>0x09,0x1e</code> 对应前面在 Ubuntu 下获取的设备码和随机码， 第五位对应设备频道编号，但表记不同的是这里的起始号为 0，因此这里的 <code>0x01</code> 对应频道 2，最后两位固定不变。</p>
<p>在理解报文规律之后，便可以放心将示例中 MX Keys 的命令 替换成适配 K375s 的了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hidapitester.exe --vidpid 046D:C52B --usage 0x0001 --usagePage 0xFF00 --open --length 7 --send-output 0x10,0x01,0x08,0x1d,0x01,0x00,0x00</span><br></pre></td></tr></table></figure>

<p>MX Master 2S 也是如此：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hidapitester.exe --vidpid 046D:C52B --usage 0x0001 --usagePage 0xFF00 --open --length 7 --send-output 0x10,0x01,0x09,0x1a,0x01,0x00,0x00</span><br></pre></td></tr></table></figure>

<p>修改保存后直接执行脚本就可以判断频道切换有没有生效了。</p>
<h4 id="2-macOS"><a href="#2-macOS" class="headerlink" title="2. macOS"></a>2. macOS</h4><p>macOS 下的配置基本上大同小异，按照 <code>switch.sh</code> 中的注视直接给变量赋值即可，除了第五位的频道编号要换成相对的数值外其余均可参照 Windows 所使用的命令。</p>
<p>同样，修改保存后执行脚本测试是否生效。</p>
<h2 id="Home-Assistant-自动化"><a href="#Home-Assistant-自动化" class="headerlink" title="Home Assistant 自动化"></a>Home Assistant 自动化</h2><p>在上面的工作全部完成之后，只需要利用 Logi Options 将脚本绑定到按键上就可以一键切换频道了。</p>
<p>当然也可以让 Home Assistant 通过 mqtt 或者 ssh 的方式从后台调用脚本，我原本就十分依赖 HA 来控制 LG C2 的信号源，而现在只需要在切换 HDMI 信号的时候顺带执行前面做好的脚本就可以实现键鼠与显示器的输入源联动了。</p>
<p>Windows 下只要用 HASS.Agent 内建的 Commands 功能就能将脚本打包成实体推送到 HA 服务器了，但 macOS 上似乎就只有 SSH 这条路比较好走了。</p>
<p>除了在设置里启用 SSH， macOS 下还要注意 Ventura 开始默认不再支持 rsa 密钥，于是改用 ed25519。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519</span><br></pre></td></tr></table></figure>

<p>另外，部署在 Docker 上的 Home Assistant 除了要映射公私钥之外，还需要确保 kown_host 文件持久化，否则每次重启容器后的第一次连接都会因为安全提示阻止脚本执行。可增加参数 <code>-o UserKnownHostsFile=CUSTOM_PATH/known_hosts</code> 重新指定文件位置。</p>
<p>最后再打包一个 Shell Command 的实例，重启 HA 就可以根据需求调用了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell_command:</span><br><span class="line">    switch_input: </span><br><span class="line">		ssh -i &#x2F;config&#x2F;.ssh&#x2F;id_ed25519 -o UserKnownHostsFile&#x3D;&#x2F;config&#x2F;.ssh&#x2F;known_hosts USER@HOST_IP &quot;bash ~&#x2F;switch.sh&quot;</span><br></pre></td></tr></table></figure>
      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Notes/" class="post-category">
    Notes
    </a>
    
      <time datetime="2023-03-14T18:23:00.000Z" itemprop="datePublished" class="post-date">
          Mar 15 2023
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Unifying/'>Unifying</a>,
    </div>
    
    <a href='/tags/Home-Assistant/'>Home Assistant</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Notes/2022/09/09/cl7yw87w500053fpm251d320s/">让 macOS 更好地合并同名文件夹</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>以往我在 Windows 下整理 NAS 上的文件时，遇到需要合并的同名文件夹时，只需要简单地把其中一个拖入到另一个文件夹所在的目录中。如若没有遇到同名文件冲突的情况，那么整个过程会在一瞬间完成，它时十分符合操作直觉的。</p>
<p>但在 macOS 下想要像这样合并两个文件夹却是意外地困难。</p>
<p>在 macOS 下，Finder 默认只为同名文件夹冲突提供了“停止”与“替换”两个选择，无须怀疑，这里的“替换”并没有字面之外意思。而在一番搜索后，不难会发现苹果设置了一个可以用 <code>opt</code> 键触发的隐藏的“合并”按钮。</p>
<p>但这个“合并”始终是以<strong>拷贝</strong>的形式进行的，这意味着每一次合并文件夹的时候 Finder 都会制造一次毫无意义的磁盘写入。而这份无意义的写入所造成的影响对于 NAS 用户来说，则会被传输协议、磁盘性能、网络带宽等因素进一步放大，最后从<strong>无意义</strong>进化成了一种<strong>折磨</strong>。</p>
<p>对此，如果不愿意选择那些更迎合 Windows 使用习惯的第三方文件管理器的话，使用跟 Finder 高度耦合的 Automator 来跑一个合并行为更接近 Windows 的脚本可以算是一个折中办法。</p>
<p>Automator 能够很方便得透过 Finder 获取所选文件的路径，同时它也能调用 Finder 的弹窗选择器来手动选择一个路径来作为变量使用。像是这样：</p>
<p><img src="/images/pasted-0.png" alt="upload successful"></p>
<p>在运行工作流的时候，所有被选择的项目的路径都会依序作为列表值被输入，而在通过请求访达项目选择输出路径后，就得到了一个类似 <code>[&#39;-c&#39;, &#39;path1&#39;, &#39;path2&#39;, &#39;path3&#39;,...&#39;pathN&#39;] </code>的列表。起始项始终是固定的值 <code>&#39;-c&#39;</code>，所以此处只需要截取第二项至倒数第二项作为 <code>src</code>，以及结尾项作为 <code>dst</code> 即可。</p>
<p>有了 <code>src</code> 和 <code>dst</code> ，事情就变得非常简单了，这里就用 Python 的 <code>shutil</code> 模块起一个脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import sys,os,shutil</span><br><span class="line"></span><br><span class="line">src &#x3D; sys.argv[1:-1]</span><br><span class="line">dst &#x3D; sys.argv[-1]</span><br><span class="line"></span><br><span class="line">for item in src:</span><br><span class="line">    for root,dirs,files in os.walk(item):</span><br><span class="line">        for file in files:</span><br><span class="line">            old &#x3D; os.path.join(root,file)</span><br><span class="line">            start &#x3D; os.path.dirname(item.rstrip(&#39;&#x2F;&#39;))</span><br><span class="line">            new &#x3D; os.path.join(dst,os.path.relpath(old,start))</span><br><span class="line">            if not os.path.exists(os.path.dirname(new)):                                             </span><br><span class="line">                os.makedirs(os.path.dirname(new))</span><br><span class="line">            shutil.move(old,new)</span><br><span class="line">    shutil.rmtree(item)</span><br></pre></td></tr></table></figure>

<p>现在将脚本拖入工作流，传递输入选择“作为自变量”，再把脚本的输出作为文本导出一份，最后这个样子就大抵堪用了。</p>
<p><img src="/images/pasted-1.png" alt="upload successful"></p>
<p>最后来验证一下，看起来没有问题</p>
<p><img src="/images/pasted-2.png" alt="upload successful"></p>

      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Notes/" class="post-category">
    Notes
    </a>
    
      <time datetime="2022-09-09T10:07:00.000Z" itemprop="datePublished" class="post-date">
          Sep 09 2022
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/macOS/'>macOS</a>,
    </div>
    
    <a href='/tags/Automator/'>Automator</a>,
    </div>
    
    <a href='/tags/Python/'>Python</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Misc/2020/12/07/cl7yw87vs00003fpmgir86jms/">独立的Plex音乐客户端：Plexamp</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p><img src="https://i.loli.net/2020/11/24/oRmlKUjC7vtHpna.png" alt="plexamp-banner"></p>
<p>今年四月，向来傲慢且怠惰的Plex一口气发布了2款手机App，分别是用于监管后台信息的Plex Dash及音乐播放器Plexamp。前者看起来是打算要取代Tautulli，后者则其实在桌面系统上由来已久。</p>
<p>先不论仅仅支持移动端的Plex Dash是否真的能代替桌面移动两开花的Tautulli，另外那个终于从桌面端滑向移动端的Plexamp则宛如重获新生。</p>
<p>如果你也使用或打算使用Plex管理音乐且正好购买了Plex Pass的话，那么Plexamp是一款能让你持续上头的音乐播放器。</p>
		
		<p>
			<a href="/Misc/2020/12/07/cl7yw87vs00003fpmgir86jms/" class="excerpt-link">Read More...</a>
		</p>
		        
      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Misc/" class="post-category">
    Misc
    </a>
    
      <time datetime="2020-12-07T13:35:00.000Z" itemprop="datePublished" class="post-date">
          Dec 07 2020
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Plex/'>Plex</a>,
    </div>
    
    <a href='/tags/Plexamp/'>Plexamp</a>,
    </div>
    
    <a href='/tags/Music/'>Music</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Life/2020/10/19/cl7yw87vz00023fpm4v1se99g/">关于跑步</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>今年从春季开始晨跑，到了六月无论如何也抵挡不住酷暑的日晒就消停了一阵子。夜跑是个不错的选择，但当时的我却无法支配夜间的时间。于是夜跑似乎便成了自由的象征，我渴望夜跑即正如我渴望自由。</p>
<p>九月的时候，工作时间终于恢复了正常。压制了数个月的跑步欲也同时迸发了出来。没多久我就因为过度运动导致的足底酸疼去到医院做了个检查，除了确诊不太意外的足底筋膜炎之外还知道了自己有足弓塌陷。幸运的是我仍能通过使用更适合平足的跑鞋或者鞋垫来继续跑步这件事，并且合理的足弓训练也可以进一步地缓解我的足底负担。</p>
<p>强行捡个不幸的事儿来说的话，那就是像我这种容易纠结的人多少还是会对此有所埋怨。我消沉了好几天，觉得这是自己作为人的缺陷。我并不为此感到自卑，但自信也仿佛因此凝固。</p>
<p>直到我再次脚踏实地地奔跑起来时，有种如同是来自灵魂深处的涌动很快就淌遍全身，像是身体的某个开关被打开，又觉得那才是自己本来该有的样子，大概那就是自我的本能对运动的渴望吧。那么，这点点不幸也就显得无关紧要了。</p>

      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Life/" class="post-category">
    Life
    </a>
    
      <time datetime="2020-10-19T15:03:00.000Z" itemprop="datePublished" class="post-date">
          Oct 19 2020
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Run/'>Run</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Misc/2020/10/01/cl7yw87xd001p3fpmg4q93xuu/">正式弃用Wordpress</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p><del>才不会说是因为没有备份Wordpress才被迫更换平台的呢。</del></p>
		
		<p>
			<a href="/Misc/2020/10/01/cl7yw87xd001p3fpmg4q93xuu/" class="excerpt-link">Read More...</a>
		</p>
		        
      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Misc/" class="post-category">
    Misc
    </a>
    
      <time datetime="2020-10-01T02:55:00.000Z" itemprop="datePublished" class="post-date">
          Oct 01 2020
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Blog/'>Blog</a>,
    </div>
    
    <a href='/tags/Hexo/'>Hexo</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Life/2020/04/07/292/">再记一次春游</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>转眼又是一个四月，今年人数比去年多了不少，算上狗狗的话约有一倍之多。</p>
<p>人一旦多起来，就难免会自然而然地分裂成好几个小圈子，如此一来人数的变化就不再那么令人在意了。</p>
<p>为了不转而在意转眼又是一年这件事上，我尝试去在意一些别的东西，例如多喝水可以改善小腿干燥，拿野餐当借口延迟戒烟之类的。</p>
<p>这样的说法也让我自己感觉奇怪——这看起来就好像时间匆匆流逝这件事情比多喝水抑或是戒烟还重要似的，明明正是因为我在过去的一年里既没有怎么多喝水，又没有好好戒掉烟，或者还有什么我记不得的事情没有完成，才使得我会去在意一年过去这件事吧。</p>
<p>当然我也很快就原谅了自己的这点小愚蠢，迅速地开始享受早春午后的慵懒。 （过程略）</p>
<p><img src="https://i.loli.net/2020/10/01/zLdZG8irOWmUQIV.jpg" alt="IMG_20201001_092220_0007"></p>

      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Life/" class="post-category">
    Life
    </a>
    
      <time datetime="2020-04-07T06:24:00.000Z" itemprop="datePublished" class="post-date">
          Apr 07 2020
      </time>
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Notes/2019/11/24/285/">在EdgeOS安装ZeroTier</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>EdgeOS更新2.0固件后底层系统从Debian7直升到了Debian9，现在已经可以直接通过ZeroTier官方提供的Linux安装脚本进行安装了。</p>
<h4 id="安装ZeroTier"><a href="#安装ZeroTier" class="headerlink" title="安装ZeroTier"></a>安装ZeroTier</h4><p>EdgeOS默认的apt源在国内的连接已经非常困难，非常容易因连接超时导致安装失败，建议自行替换国内镜像源。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -i curl -s https://install.zerotier.com | sudo bash</span><br></pre></td></tr></table></figure>
<p>安装成功后你将得到一个ZeroTier的Client ID。 接着用ZeroTier官网申请的网络ID来加入网络即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zerotier-cli join [NETWORK-ID]</span><br></pre></td></tr></table></figure>


<h4 id="保护配置文件"><a href="#保护配置文件" class="headerlink" title="保护配置文件"></a>保护配置文件</h4><p>为防止因固件升级导致配置文件丢失，我们可以把ZT的配置文件移动到/config/scripts再软连接回到原路径,这样在每次更新固件后重新执行一遍软连接就可以轻松恢复配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /var/lib/zerotier-one /config/scripts/ ln -s /config/scripts/zerotier-one</span><br></pre></td></tr></table></figure>

<h4 id="映射网络接口（可选）"><a href="#映射网络接口（可选）" class="headerlink" title="映射网络接口（可选）"></a>映射网络接口（可选）</h4><p>EdgeOS无法识别ZeroTier的接口（ZT0），因此ZT0不会反映到EdgeOS的WEBUI上面。但即便如此，ZeroTier依然能够正常工作。 如果你闲得蛋疼，路由器上又正好有空闲的网口没地方用，那么可以来试一下把zt0映射到eth(0~4)上面。 <em>在/var/lib/zerotier-one下创建一个devicemap文件，内容如下（将X替换成你闲置的那个口，下略）</em> </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;zerotiernetworkid&gt;=ethX</span><br></pre></td></tr></table></figure>

<p>重启ZeroTier </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/zerotier-one restart</span><br></pre></td></tr></table></figure>

<p>这时ifconfig下的ethX应该已经对应zt0的接口信息了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> interfaces ethernet ethX description <span class="string">&quot;ZeroTier [NETWORK-ID]&quot;</span></span><br><span class="line">commit save</span><br></pre></td></tr></table></figure>


      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Notes/" class="post-category">
    Notes
    </a>
    
      <time datetime="2019-11-24T10:18:00.000Z" itemprop="datePublished" class="post-date">
          Nov 24 2019
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/ER-X/'>ER-X</a>,
    </div>
    
    <a href='/tags/ubnt/'>ubnt</a>,
    </div>
    
    <a href='/tags/ZeroTier/'>ZeroTier</a>,
    </div>
    
    <a href='/tags/Linux/'>Linux</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Misc/2019/05/09/243/">过气HTPC升级记</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>HP MICROSEVER GEN8是我钟爱的一款适合当NAS的微型服务器，但当初考虑到客厅三星电视的Tizen ≈ 无系统，NAS+HTPC的方案看起来会挺棒，于是就有了这个（现在看来这是一个坏主意）。</p>
		
		<p>
			<a href="/Misc/2019/05/09/243/" class="excerpt-link">Read More...</a>
		</p>
		        
      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Misc/" class="post-category">
    Misc
    </a>
    
      <time datetime="2019-05-09T06:22:00.000Z" itemprop="datePublished" class="post-date">
          May 09 2019
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Kodi/'>Kodi</a>,
    </div>
    
    <a href='/tags/HTPC/'>HTPC</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Misc/2019/05/04/241/">无法逃离PLEX的魔爪</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>在搞定IPV6后终于可以如愿以偿地在地铁上听PLEX上的歌了，但不知是我家上行带宽太小还是IPV6本身不稳定的缘故，间歇性的连接失败总是在比较尴尬的时刻来临。</p>
<p>想了想我收藏的歌其实也不是很多，为什么不直接把它们丢在第三方公有云上呢。一番搜索后得知吃灰已久的Apple Music已经提供类似网易音乐云盘的功能（iTunes Match）。</p>
<p>PLEX本身不会去修改任何文件信息（比如ID3），所以如果要打算回到iTunes上，那么从源头去整理ID3才是一劳永逸的</p>
<p>继续一番搜索后找到了这个叫MusicBrainz的服务。</p>
<p>使用下来匹配精度要比PLEX高不少，针对一些疑难杂歌提供的手动匹配功能也非常顺手，唯一的缺点大概就是它只使用自家的数据库以至于确实有一部分刮削不到信息，但对于勤劳的我来说只要能自行编辑数据库那就不是问题。</p>
<p>得益于MusicBrainz优秀的操作体验，我花了大概儿时手动整理歌曲1/100的时间就处理完了大半的歌。</p>
<p>在批量执行ID3写入的时间里我打开了那个又卡又臃肿的iTunes，一边导入音乐库的同时我掏出了手机正准备订阅AM会员。而就在我打算支付的时候我才注意到资料库依旧是空空如也。</p>
<p>嗯！9102年了iTunes还是不支持FLAC。</p>
<p>iTunes再见，PLEX我又回来了。</p>

      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Misc/" class="post-category">
    Misc
    </a>
    
      <time datetime="2019-05-04T15:53:00.000Z" itemprop="datePublished" class="post-date">
          May 04 2019
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Plex/'>Plex</a>,
    </div>
    
    <a href='/tags/MusicBrainz/'>MusicBrainz</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <article class="post" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
    
    <header class="post-header">
      

  <h2 class="post-title" itemprop="name">
    <a href="/Notes/2019/04/26/233/">通过IPv6连接你的Plex服务器</a>
  </h2>


    </header>
    
    <section class="post-excerpt" itemprop="description articleBody">
      <p>
      
        <p>目前国内IPv6的推进速度已经相当不错，对于有家庭服务器需求的用户来说，获取一个不知道能用多久的公网IPv4可能已经远远超过了获得原生IPv6的难度。 长期受到无公网IP的我拿到IPv6后想到的第一件事就是试试能不能透过公网连接自家的PLEX库。</p>
<h5 id="前期工作"><a href="#前期工作" class="headerlink" title="前期工作"></a>前期工作</h5><p>首先是配置路由器给局域各网客户机分配地址，不同路由系统对IPv6的自动化配置程度有所差异，我的Ubnt ER-X就属于比较麻烦的那种，好在官方论坛已经有比较详尽的配置示范。 仅仅配置完路由器后还无法通过IPv6测试，打开WIN10的防火墙，添加一条入站规则放行ICMPv6后一切显示正常。 <a href="https://rosystain.com/wp-content/uploads/2019/04/Snipaste_2019-04-26_15-26-43.png"><img src="https://rosystain.com/wp-content/uploads/2019/04/Snipaste_2019-04-26_15-26-43.png"></a></p>
		
		<p>
			<a href="/Notes/2019/04/26/233/" class="excerpt-link">Read More...</a>
		</p>
		        
      
      </p>
    </section>
    <section class="post-meta">
    
      <span> Chock</span>
    
    on 
    <a href="/categories/Notes/" class="post-category">
    Notes
    </a>
    
      <time datetime="2019-04-26T08:27:00.000Z" itemprop="datePublished" class="post-date">
          Apr 26 2019
      </time>
      
    
    <div class="post-meta-tags">
    
    <a href='/tags/Plex/'>Plex</a>,
    </div>
    
    <a href='/tags/IPv6/'>IPv6</a>
    </div>
    
    
</section>


                                
                                    
                                
  </article>
  
  <nav class="pagination" role="pagination">
    
    <span class="page-number">Page 1 of 2</span>
    <a class="older-posts" href="/archives/page/2/">Older Posts →</a>
  </nav>
</main>


  <footer class="site-footer clearfix">
 <section class="copyright"><a href="/">痴呆屋</a> &copy; <script>document.write(new Date().getFullYear())</script> &bull; All rights reserved.</section>
</footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/jquery-2.0.3.min.js"><\/script>')</script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript">
(function($){
  var $postContent = $(".post-content");
  $postContent.fitVids();
})(jQuery);
</script>

<script type="text/javascript" src="/js/index.js"></script>





</body>
</html>
